suite: test general enabled flag behavior
templates:
  - templates/*.yaml
excludeTemplates:
  - templates/helmrepository.yaml
  - templates/notifier.yaml
  - templates/tailscale.yaml
tests:
  - it: should render jail logs component when jailLogs.enabled=true
    set:
      observability.opentelemetry.logs.values.jailLogs.enabled: true
    asserts:
      - hasDocuments:
          count: 1
  - it: should render node logs when nodeLogs.enabled=true (default)
    templates:
      - templates/opentelemetry-collector-logs.yaml
    asserts:
      - exists:
          path: spec.values.config.receivers["filelog/nodelogs"]
  - it: should not render node logs when nodeLogs.enabled=false
    set:
      observability.opentelemetry.logs.values.nodeLogs.enabled: false
    templates:
      - templates/opentelemetry-collector-logs.yaml
    asserts:
      - notExists:
          path: spec.values.config.receivers["filelog/nodelogs"]
