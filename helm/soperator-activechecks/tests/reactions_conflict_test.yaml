suite: reactions conflict
templates:
  - templates/ib-gpu-perf.yaml

tests:
  - it: should fail if both commentPrefix and drainReasonPrefix are set
    set:
      checks:
        ibGpuPerf:
          commentPrefix: "[node_problem]"
          drainReasonPrefix: "[node_problem]"
    asserts:
      - failedTemplate:
          errorMessage: "checks.ibGpuPerf: cannot set both commentPrefix and drainReasonPrefix simultaneously"

  - it: should render when only commentPrefix is set
    set:
      checks:
        ibGpuPerf:
          commentPrefix: "[node_problem]"
          drainReasonPrefix: null
    asserts:
      - notFailedTemplate: {}

  - it: should render when only drainReasonPrefix is set
    set:
      checks:
        ibGpuPerf:
          drainReasonPrefix: "[node_problem]"
          commentPrefix: null
    asserts:
      - notFailedTemplate: {}

  - it: should render when both prefixes are explicitly null
    set:
      checks:
        ibGpuPerf:
          commentPrefix: null
          drainReasonPrefix: null
    asserts:
      - notFailedTemplate: {}